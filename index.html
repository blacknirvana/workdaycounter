<!-- Version: 2026-01-08 -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Workday Countdown</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Mozilla+Text:wght@200..700&family=Overpass:ital,wght@0,100..900;1,100..900&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: "Roboto", sans-serif;
            font-optical-sizing: auto;
            margin: 0;
            height: 100vh;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .panel {
            background: rgba(0, 0, 0, 0.55);
            backdrop-filter: blur(8px);
            border-radius: 20px;
            padding: 30px 40px;
            color: #fff;
            text-align: center;
            min-width: 320px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.5);
            z-index: 1;
        }

        .countdown {
            font-size: 5rem;
            font-weight: bold;
            margin-bottom: 25px;
        }

        .controls {
            display: grid;
            grid-template-columns: auto auto;
            gap: 10px 20px;
            align-items: center;
            margin-bottom: 15px;
        }

        input, button {
            padding: 6px;
            font-size: 1rem;
            border-radius: 6px;
            border: none;
        }

        button {
            grid-column: span 2;
            cursor: pointer;
            background: #222;
            color: #fff;
        }

        button:hover {
            background: #333;
        }

        .results div {
            margin: 6px 0;
            font-size: 1.05rem;
        }

        .label {
            color: #ccc;
        }

        /* ---------- Corner overlay ---------- */
        .corner {
            position: fixed;
            bottom: 12px;
            font-size: 0.85rem;
            color: #eee;
            background: rgba(0,0,0,0.45);
            backdrop-filter: blur(4px);
            padding: 6px 10px;
            border-radius: 8px;
        }

        .corner a {
            color: #fff;
            text-decoration: underline;
        }

        .bottom-left {
            left: 12px;
        }

        .bottom-right {
            right: 12px;
        }

        .corner button {
            all: unset;
            cursor: pointer;
            font-weight: bold;
        }
    </style>
</head>
<body>

<div class="panel">
    <div class="countdown" id="countdown">--:--:--</div>

    <div class="controls">
        <label for="startTime">Start time</label>
        <input type="time" id="startTime">

        <label for="lunch">Lunch (minutes)</label>
        <input type="number" id="lunch" min="0">

        <label for="extratime">Extra (minutes)</label>
        <input type="number" id="extratime" min="0">

        <button id="clear">Clear saved data</button>
    </div>

    <div class="results">
        <div>
            <span class="label">End time (no extra time): </span>
            <span id="endNormal">--:--</span>
        </div>
        <div>
            <span class="label">End time (+ extra time): </span>
            <span id="endPlus">--:--</span>
        </div>
    </div>
</div>

<!-- Corner UI -->
<div class="corner bottom-left">
    <button id="newPhoto">ðŸ”„ New Photo</button>
</div>

<div class="corner bottom-right" id="credit">
    Photo by â€”
</div>

<script>
/* =============================
   CONFIG
============================= */
const PEXELS_API_KEY = "sI3jtU1iPBlVfOZ01mDGffVEHeB9FlVjPLP3ExQNy7pedRP4c5GK6LQn";

/* =============================
   BACKGROUND IMAGE
============================= */
async function loadBackground() {
    try {
        const page = Math.floor(Math.random() * 100) + 1;
        const res = await fetch(
            `https://api.pexels.com/v1/search?query=nature&orientation=landscape&per_page=1&page=${page}`,
            {
                headers: { Authorization: PEXELS_API_KEY }
            }
        );

        const data = await res.json();
        if (data.photos?.length) {
            const photo = data.photos[0];
            document.body.style.backgroundImage =
                `url(${photo.src.original})`;

            document.getElementById("credit").innerHTML =
                `Photo by <a href="${photo.photographer_url}" target="_blank">${photo.photographer}</a> on <a href="https://www.pexels.com" target="_blank">Pexels</a>`;
        }
    } catch (e) {
        console.error("Failed to load background image", e);
    }
}

document.getElementById("newPhoto").addEventListener("click", loadBackground);

/* =============================
   TIME LOGIC
============================= */
const WORK_MINUTES = 7 * 60 + 15;

const startInput = document.getElementById("startTime");
const lunchInput = document.getElementById("lunch");
const extratimeInput = document.getElementById("extratime");
const countdownEl = document.getElementById("countdown");
const endNormalEl = document.getElementById("endNormal");
const endPlusEl = document.getElementById("endPlus");
const clearBtn = document.getElementById("clear");

/* ---------- Local storage ---------- */
function saveSettings() {
    localStorage.setItem("startTime", startInput.value);
    localStorage.setItem("lunchMinutes", lunchInput.value);
    localStorage.setItem("extraMinutes", extratimeInput.value);
}

function loadSettings() {
    const s = localStorage.getItem("startTime");
    const l = localStorage.getItem("lunchMinutes");
    const e = localStorage.getItem("extraMinutes");
    if (s) startInput.value = s;
    if (l) lunchInput.value = l;
    if (e) extratimeInput.value = e;
}

function clearSettings() {
    localStorage.removeItem("startTime");
    localStorage.removeItem("lunchMinutes");
    localStorage.removeItem("extraMinutes");
    startInput.value = "";
    lunchInput.value = "";
    extratimeInput.value = "";
}

/* ---------- Time math ---------- */
function formatTime(date) {
    return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
}

function calculateTimes() {
    if (!startInput.value) return null;

    const [h, m] = startInput.value.split(":").map(Number);
    const lunch = parseInt(lunchInput.value || 0);
    const extra = parseInt(extratimeInput.value || 0);

    const start = new Date();
    start.setHours(h, m, 0, 0);

    const endNormal = new Date(start);
    endNormal.setMinutes(endNormal.getMinutes() + WORK_MINUTES + lunch);

    const endPlus = new Date(endNormal);
    endPlus.setMinutes(endPlus.getMinutes() + extra);

    endNormalEl.textContent = formatTime(endNormal);
    endPlusEl.textContent = formatTime(endPlus);

    return endPlus;
}

function updateCountdown() {
    const target = calculateTimes();
    if (!target) {
        countdownEl.textContent = "--:--:--";
        return;
    }

    let diff = Math.floor((target - new Date()) / 1000);
    if (diff <= 0) {
        countdownEl.textContent = "00:00:00";
        return;
    }

    const h = Math.floor(diff / 3600);
    diff %= 3600;
    const m = Math.floor(diff / 60);
    const s = diff % 60;

    countdownEl.textContent =
        `${String(h).padStart(2,"0")}:` +
        `${String(m).padStart(2,"0")}:` +
        `${String(s).padStart(2,"0")}`;
}

/* ---------- Events ---------- */
startInput.addEventListener("change", () => {
    saveSettings();
    updateCountdown();
});

lunchInput.addEventListener("input", () => {
    saveSettings();
    updateCountdown();
});

extratimeInput.addEventListener("input", () => {
    saveSettings();
    updateCountdown();
});

clearBtn.addEventListener("click", () => {
    clearSettings();
    updateCountdown();
});

/* ---------- Init ---------- */
loadSettings();
loadBackground();
setInterval(updateCountdown, 1000);
updateCountdown();
</script>

</body>
</html>

